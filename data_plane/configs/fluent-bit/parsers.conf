# =============================================================================
# Fluent Bit Parsers
# =============================================================================

[PARSER]
    Name        json
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L

[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name        auditd
    Format      regex
    Regex       ^type=(?<type>[^ ]+) msg=audit\((?<timestamp>[^:]+):[^)]+\): (?<message>.*)$
    Time_Key    timestamp
    Time_Format %s.%L

[PARSER]
    Name        auditd_user
    Format      regex
    Regex       uid=(?<uid>\d+).*auid=(?<auid>\d+).*exe="(?<exe>[^"]+)".*

[PARSER]
    Name        command_audit
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) \[(?<pid>\d+)\] (?<user>[^@]+)@(?<host>[^:]+):(?<pwd>[^ ]+) \$ (?<command>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S

[PARSER]
    Name        syslog
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
