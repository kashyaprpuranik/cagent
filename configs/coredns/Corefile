# =============================================================================
# CoreDNS Configuration - Auto-generated from cagent.yaml
# Generated: 2026-02-16T16:18:01.964327Z
# DO NOT EDIT - changes will be overwritten
# =============================================================================

# Devbox.local aliases -> Envoy proxy (10.200.1.10)
devbox.local {
    template IN A {
        answer "{{ .Name }} 60 IN A 10.200.1.10"
    }
    template IN AAAA {
        rcode NOERROR
    }
    log
}

# Allowlisted domains
api.anthropic.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

api.github.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

api.openai.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

cdn-lfs.huggingface.co {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

codeload.github.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

echo-server {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

files.pythonhosted.org {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

gist.githubusercontent.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

github.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

huggingface.co {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

objects.githubusercontent.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

pypi.org {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

raw.githubusercontent.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

registry.npmjs.org {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

registry.yarnpkg.com {
    forward . 8.8.8.8 8.8.4.4
    cache 300
    log
}

# Internal services (Docker DNS)
backend {
    forward . 127.0.0.11
    log
}

envoy {
    forward . 127.0.0.11
    log
}

dns-filter {
    forward . 127.0.0.11
    log
}

vector {
    forward . 127.0.0.11
    log
}

# Catch-all: health, metrics, and block non-allowlisted domains
. {
    health :8080
    prometheus :9153

    log . {
        class all
    }
    errors

    # Return NXDOMAIN for non-allowlisted domains
    template ANY ANY {
        rcode NXDOMAIN
    }
}